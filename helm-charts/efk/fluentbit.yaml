image:
  fluent_bit:
    repository: fluent/fluent-bit
    tag: 1.0.6

backend:
  type: es
  es:
    host: es-index-elasticsearch-client.elasticsearch.svc.cluster.local
    time_key: "@timestamp_fb"
    port: 9200

parsers:
  enabled: true
  regex:
  - name: haproxy
    regex: '^(?:<|(?:u003c))(?:\d+)(?:>|(?:u003e))(?:\w{3}\s+\d+\s\d{2}:\d{2}:\d{2})\shaproxy\[(?<pid>\d)\]:\s(?<ip>(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)):(?<port>\d+)\s\[(?<time>\d{2}\/\w{3}\/\d{4}:\d{2}:\d{2}:\d{2}\.\d{3})\]\s(?<protocol>\w+)\s(?<backend>\w+)\/(?<server>[^\s]+)\s(?<TR>\d+)\/(?<Tw>\d+)\/(?<Tc>\d+)\/(?<Tr>\d+)\/(?<Ta>\d+)\s(?<status>\d{3})\s(?<bytes_read>\d+)\s(?<captured_req_cookie>[^\s]+)\s(?<captured_resp_cookie>[^\s]+)\s(?<termination_state>[^\s]+)\s(?<actconn>\d+)\/(?<feconn>\d+)\/(?<beconn>\d+)\/(?<srv_conn>\d+)\/(?<retries>\d+)\s(?<srv_queue>\d+)\/(?<backend_queue>\d+)\s\{(?<captured_headers>[^\}]*)\}\s\"(?<request>[^\"]*)\"$'
    timeKey: time
    timeFormat: "%d/%b/%Y:%H:%M:%S.%f"
